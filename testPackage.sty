\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{testPackage}

\RequirePackage{tikz}
\usepgflibrary{arrows.meta}

\RequirePackage{etoolbox}

\newcommand{\changedimension}[4]{
    \ifblank{#2}{
        Is blank: #1, #2, #3, #4
    }{
        Isn't blank: #1, #2, #3, #4
    }
}

\input{Pumps}
\input{Drier}
\input{CoolingTower}
\input{Crusher}
\input{Mill}
\input{Press}
\input{Separators}
\input{Valve}
\input{SafetyFittings}

\pgfkeys{
        /compressor/radius/.code = {#1},
        /compressor/radius/.initial = 1cm,
        /compressor/angleOne/.code = {#1},
        /compressor/angleOne/.initial = 10,
        /compressor/angleTwo/.code = {#1},
        /compressor/angleTwo/.initial = 130
}

\pgfdeclareshape{compressor}{
    \savedanchor{\centerpoint}{
        \pgfpointorigin
    }
    \savedanchor{\north}{
        \pgfpoint{0}{\pgfkeysvalueof{/compressor/radius}}
    }
    \savedanchor{\east}{
        \pgfpoint{\pgfkeysvalueof{/compressor/radius}}{0}
    }

    
    \anchor{center}{
        \centerpoint
    }
    \anchor{north}{
        \north
    }
    \anchor{east}{
        \east
    }
    \anchor{south}{
        \north
        \pgfpoint{\pgf@x}{-\pgf@y}
    }
    \anchor{west}{
        \east
        \pgfpoint{-\pgf@x}{\pgf@y}
    }


    \backgroundpath{
        \pgfpathmoveto{\pgfpointorigin}
        \pgfpathcircle{\pgfpointorigin}{\pgfkeysvalueof{/compressor/radius}}
    
        \pgfpathmoveto{\pgfpointpolar{\pgfkeysvalueof{/compressor/angleOne}}{\pgfkeysvalueof{/compressor/radius}}}
        \pgfpathlineto{\pgfpointpolar{\pgfkeysvalueof{/compressor/angleTwo}}{\pgfkeysvalueof{/compressor/radius}}}
        
        \pgfpathmoveto{\pgfpointpolar{-\pgfkeysvalueof{/compressor/angleOne}}{\pgfkeysvalueof{/compressor/radius}}}
        \pgfpathlineto{\pgfpointpolar{-\pgfkeysvalueof{/compressor/angleTwo}}{\pgfkeysvalueof{/compressor/radius}}}
        
        \pgfusepath{stroke}
    }
}

\endinput